*------------------------------------------------------------*;
* EM Version: 13.2;
* SAS Release: 9.04.01M2P062414;
* Host: LINCOLN;
* Project Path: D:\All_Users\pathal\EMProj;
* Project Name: ccp;
* Diagram Id: EMWS2;
* Diagram Name: profile;
* Generated by: pathal;
* Date: 26JUN2014:01:51:36;
*------------------------------------------------------------*;
*------------------------------------------------------------*;
* Macro Variables;
*------------------------------------------------------------*;
%let EM_PROJECT =;
%let EM_PROJECTNAME =;
%let EM_WSNAME =;
%let EM_WSDESCRIPTION =profile;
%let EM_SUMMARY =WORK.SUMMARY;
%let EM_NUMTASKS =SINGLE;
%let EM_EDITMODE =R;
%let EM_DEBUGVAL =;
%let EM_ACTION =run;
*------------------------------------------------------------*;
%macro em_usedatatable;
%if ^%symexist(EM_USEDATATABLE) %then %do;
%let EM_USEDATATABLE = Y;
%end;
%if "&EM_USEDATATABLE" ne "N" %then %do;
%global Ids_data Ids_newdata;
*------------------------------------------------------------*;
* Data Tables;
*------------------------------------------------------------*;
%let Ids_data = CCP.PATIENT_HISTORY_STD;
%let Ids_newdata =;
*------------------------------------------------------------*;
%end;
%global Ids_source;
%if "&Ids_newdata" ne "" %then %do;
%let Ids_source = USERTABLE;
%end;
%else %do;
%let Ids_source = DATASOURCE;
%end;
%mend em_usedatatable;
%em_usedatatable;
*------------------------------------------------------------*;
* Create workspace data set;
*------------------------------------------------------------*;
data workspace;
length property $64 value $200;
property= 'PROJECTLOCATION';
value= "&EM_PROJECT";
output;
property= 'PROJECTNAME';
value= "&EM_PROJECTNAME";
output;
property= 'WORKSPACENAME';
value= "&EM_WSNAME";
output;
property= 'WORKSPACEDESCRIPTION';
value= "&EM_WSDESCRIPTION";
output;
property= 'SUMMARYDATASET';
value= "&EM_SUMMARY";
output;
property= 'NUMTASKS';
value= "&EM_NUMTASKS";
output;
property= 'EDITMODE';
value= "&EM_EDITMODE";
output;
property= 'DEBUG';
value= "&EM_DEBUGVAL";
output;
run;
*------------------------------------------------------------*;
* Create nodes data set;
*------------------------------------------------------------*;
data nodes;
length id $12 component $32 description $64 X 8 Y 8 diagramID $32 parentID $32;
id= "Smpl";
component="Sample";
description= "Sample";
diagramID="_ROOT_";
parentID="";
X=257;
Y=58;
output;
id= "Prof";
component="Profile";
description= "Segment Profile";
diagramID="_ROOT_";
parentID="";
X=681;
Y=58;
output;
id= "Ids";
component="DataSource";
description= "PATIENT_HISTORY_STD";
diagramID="_ROOT_";
parentID="";
X=60;
Y=58;
output;
id= "EMCODE";
component="SASCode";
description= "SAS Code";
diagramID="_ROOT_";
parentID="";
X=462;
Y=58;
output;
run;
*------------------------------------------------------------*;
* DataSource Properties;
*------------------------------------------------------------*;
data WORK.patienthistorystd_P;
  length   Property                         $ 32
           Value                            $ 200
           ;

Property="Name";
Value="PATIENT_HISTORY_STD";
output;
Property="CreateDate";
Value="1719143183.3";
output;
Property="ModifyDate";
Value="1719143183.3";
output;
Property="CreatedBy";
Value="pathal";
output;
Property="ModifiedBy";
Value="pathal";
output;
Property="SampleSizeType";
Value="";
output;
Property="SampleSize";
Value="";
output;
;
run;
*------------------------------------------------------------*;
* EMNOTES File for Smpl;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"Smpl_EMNOTES.txt";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath" encoding="utf-8" NOBOM;
file dspath;
run;
*------------------------------------------------------------*;
* USERTRAINCODE File for Prof;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"Prof_USERTRAINCODE.sas";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath";
file dspath;
run;
*------------------------------------------------------------*;
* EMNOTES File for Prof;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"Prof_EMNOTES.txt";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath" encoding="utf-8" NOBOM;
file dspath;
run;
*------------------------------------------------------------*;
* Variable Attributes for Ids;
*------------------------------------------------------------*;
data WORK.Ids_VariableAttribute;
length Variable $64 AttributeName $32 AttributeValue $64;
Variable='ASSOC_REVIEW_SCORE';
AttributeName="LEVEL";
AttributeValue='NOMINAL';
Output;
Variable='CLUSTER_REVIEW_SCORE';
AttributeName="LEVEL";
AttributeValue='NOMINAL';
Output;
Variable='COL1';
AttributeName="ROLE";
AttributeValue='REJECTED';
Output;
Variable='COL10';
AttributeName="ROLE";
AttributeValue='REJECTED';
Output;
Variable='COL2';
AttributeName="ROLE";
AttributeValue='REJECTED';
Output;
Variable='COL3';
AttributeName="ROLE";
AttributeValue='REJECTED';
Output;
Variable='COL4';
AttributeName="ROLE";
AttributeValue='REJECTED';
Output;
Variable='COL5';
AttributeName="ROLE";
AttributeValue='REJECTED';
Output;
Variable='COL6';
AttributeName="ROLE";
AttributeValue='REJECTED';
Output;
Variable='COL7';
AttributeName="ROLE";
AttributeValue='REJECTED';
Output;
Variable='COL8';
AttributeName="ROLE";
AttributeValue='REJECTED';
Output;
Variable='COL9';
AttributeName="ROLE";
AttributeValue='REJECTED';
Output;
Variable='ENCODED_AGE';
AttributeName="ROLE";
AttributeValue='REJECTED';
Output;
Variable='ENCODED_GENDER';
AttributeName="ROLE";
AttributeValue='REJECTED';
Output;
Variable='ENCODED_INCOME';
AttributeName="ROLE";
AttributeValue='REJECTED';
Output;
Variable='FRAUD_RANK';
AttributeName="LEVEL";
AttributeValue='NOMINAL';
Output;
Variable='REVIEW_FLAG';
AttributeName="LEVEL";
AttributeValue='BINARY';
Output;
Variable='_CLUSTER_ID_';
AttributeName="ROLE";
AttributeValue='SEGMENT';
Output;
Variable='gender';
AttributeName="LEVEL";
AttributeValue='BINARY';
Output;
Variable='id';
AttributeName="LEVEL";
AttributeValue='INTERVAL';
Output;
run;
*------------------------------------------------------------*;
* EMNOTES File for Ids;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"Ids_EMNOTES.txt";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath" encoding="utf-8" NOBOM;
file dspath;
run;
*------------------------------------------------------------*;
* USERTRAINCODE File for EMCODE;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"EMCODE_USERTRAINCODE.sas";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath";
file dspath;
put 'data &EM_EXPORT_TRAIN;';
put '	set &EM_IMPORT_DATA;';
put '	if _CLUSTER_ID_ in (324, 104, 855, 919, 82, 905);';
put 'run;';
run;
*------------------------------------------------------------*;
* EMNOTES File for EMCODE;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"EMCODE_EMNOTES.txt";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath" encoding="utf-8" NOBOM;
file dspath;
run;
*------------------------------------------------------------*;
* Create node properties data set;
*------------------------------------------------------------*;
data nodeprops;
length id $12 property $64 value $400;
id= "Smpl";
property="Method";
value= "DEFAULT";
output;
id= "Smpl";
property="SizeType";
value= "PERCENT";
output;
id= "Smpl";
property="SizePercent";
value= "10";
output;
id= "Smpl";
property="SizeObs";
value= ".";
output;
id= "Smpl";
property="RandomSeed";
value= "12345";
output;
id= "Smpl";
property="Alpha";
value= "0.01";
output;
id= "Smpl";
property="Pvalue";
value= "0.01";
output;
id= "Smpl";
property="AdjustFreq";
value= "N";
output;
id= "Smpl";
property="FreqMiss";
value= "N";
output;
id= "Smpl";
property="FreqCount";
value= "N";
output;
id= "Smpl";
property="StratifyCriterion";
value= "PROPORTIONAL";
output;
id= "Smpl";
property="MinStrataSize";
value= "5";
output;
id= "Smpl";
property="IgnoreSmallStrata";
value= "N";
output;
id= "Smpl";
property="ClusterMethod";
value= "RANDOM";
output;
id= "Smpl";
property="LevelProportion";
value= "100";
output;
id= "Smpl";
property="LevelSampleProportion";
value= "50";
output;
id= "Smpl";
property="LevelSelection";
value= "EVENT";
output;
id= "Smpl";
property="OutputType";
value= "DATA";
output;
id= "Smpl";
property="IntervalDistribution";
value= "Y";
output;
id= "Smpl";
property="ClassDistribution";
value= "Y";
output;
id= "Smpl";
property="ForceRun";
value= "N";
output;
id= "Smpl";
property="RunAction";
value= "Train";
output;
id= "Smpl";
property="Component";
value= "Sample";
output;
id= "Smpl";
property="EM_FILE_EMNOTES";
value= "Smpl_EMNOTES.txt";
output;
id= "Prof";
property="Location";
value= "CATALOG";
output;
id= "Prof";
property="Catalog";
value= "SASHELP.EMEXPL.PROFILE.SOURCE";
output;
id= "Prof";
property="DataNeeded";
value= "Y";
output;
id= "Prof";
property="MinWorth";
value= "0.001";
output;
id= "Prof";
property="MaxNumInput";
value= "10";
output;
id= "Prof";
property="MaxNumReport";
value= "10";
output;
id= "Prof";
property="NumHistBars";
value= "8";
output;
id= "Prof";
property="ProfileAll";
value= "N";
output;
id= "Prof";
property="PrintWorth";
value= "Y";
output;
id= "Prof";
property="UseReportVars";
value= "Y";
output;
id= "Prof";
property="TargetRole";
value= "NONE";
output;
id= "Prof";
property="OtherPercentCutOff";
value= "95";
output;
id= "Prof";
property="MaxDepth";
value= "1";
output;
id= "Prof";
property="ForceRun";
value= "N";
output;
id= "Prof";
property="RunAction";
value= "Train";
output;
id= "Prof";
property="Component";
value= "Profile";
output;
id= "Prof";
property="ToolType";
value= "ASSESS";
output;
id= "Prof";
property="ToolPrefix";
value= "Prof";
output;
id= "Prof";
property="EM_FILE_USERTRAINCODE";
value= "Prof_USERTRAINCODE.sas";
output;
id= "Prof";
property="EM_FILE_EMNOTES";
value= "Prof_EMNOTES.txt";
output;
id= "Ids";
property="DataSource";
value= "patienthistorystd";
output;
id= "Ids";
property="Scope";
value= "LOCAL";
output;
id= "Ids";
property="Role";
value= "RAW";
output;
%let Ids_lib = %scan(&Ids_data, 1, .);
id= "Ids";
property="Library";
value= "&Ids_lib";
output;
%let Ids_member = %scan(&Ids_data, 2, .);
id= "Ids";
property="Table";
value= "&Ids_member";
output;
id= "Ids";
property="NCols";
value= "22";
output;
id= "Ids";
property="NObs";
value= "100001224";
output;
id= "Ids";
property="NBytes";
value= "19275580416";
output;
id= "Ids";
property="Segment";
value= "";
output;
id= "Ids";
property="DataSourceRole";
value= "RAW";
output;
id= "Ids";
property="OutputType";
value= "VIEW";
output;
id= "Ids";
property="ForceRun";
value= "N";
output;
id= "Ids";
property="ComputeStatistics";
value= "N";
output;
id= "Ids";
property="DataSelection";
value= "&Ids_source";
output;
id= "Ids";
property="NewTable";
value= "&Ids_newdata";
output;
id= "Ids";
property="MetaAdvisor";
value= "BASIC";
output;
id= "Ids";
property="ApplyIntervalLevelLowerLimit";
value= "Y";
output;
id= "Ids";
property="IntervalLowerLimit";
value= "20";
output;
id= "Ids";
property="ApplyMaxPercentMissing";
value= "Y";
output;
id= "Ids";
property="MaxPercentMissing";
value= "50";
output;
id= "Ids";
property="ApplyMaxClassLevels";
value= "Y";
output;
id= "Ids";
property="MaxClassLevels";
value= "20";
output;
id= "Ids";
property="IdentifyEmptyColumns";
value= "Y";
output;
id= "Ids";
property="VariableValidation";
value= "STRICT";
output;
id= "Ids";
property="NewVariableRole";
value= "REJECT";
output;
id= "Ids";
property="DropMapVariables";
value= "Y";
output;
id= "Ids";
property="DsId";
value= "patienthistorystd";
output;
id= "Ids";
property="DsSampleName";
value= "";
output;
id= "Ids";
property="DsSampleSizeType";
value= "";
output;
id= "Ids";
property="DsSampleSize";
value= "";
output;
id= "Ids";
property="DsCreatedBy";
value= "pathal";
output;
id= "Ids";
property="DsCreateDate";
value= "1719143183.3";
output;
id= "Ids";
property="DsModifiedBy";
value= "pathal";
output;
id= "Ids";
property="DsModifyDate";
value= "1719143183.3";
output;
id= "Ids";
property="DsScope";
value= "LOCAL";
output;
id= "Ids";
property="Sample";
value= "D";
output;
id= "Ids";
property="SampleSizeType";
value= "PERCENT";
output;
id= "Ids";
property="SampleSizePercent";
value= "20";
output;
id= "Ids";
property="SampleSizeObs";
value= "10000";
output;
id= "Ids";
property="DBPassThrough";
value= "Y";
output;
id= "Ids";
property="RunAction";
value= "Train";
output;
id= "Ids";
property="Component";
value= "DataSource";
output;
id= "Ids";
property="Description";
value= "";
output;
id= "Ids";
property="EM_VARIABLEATTRIBUTES";
value= "WORK.Ids_VariableAttribute";
output;
id= "Ids";
property="EM_FILE_EMNOTES";
value= "Ids_EMNOTES.txt";
output;
id= "EMCODE";
property="UsePriors";
value= "Y";
output;
id= "EMCODE";
property="ToolType";
value= "UTILITY";
output;
id= "EMCODE";
property="DataNeeded";
value= "N";
output;
id= "EMCODE";
property="PublishCode";
value= "PUBLISH";
output;
id= "EMCODE";
property="ScoreCodeFormat";
value= "DATASTEP";
output;
id= "EMCODE";
property="MetaAdvisor";
value= "BASIC";
output;
id= "EMCODE";
property="ForceRun";
value= "N";
output;
id= "EMCODE";
property="RunAction";
value= "Train";
output;
id= "EMCODE";
property="Component";
value= "SASCode";
output;
id= "EMCODE";
property="ToolPrefix";
value= "EMCODE";
output;
id= "EMCODE";
property="EM_FILE_USERTRAINCODE";
value= "EMCODE_USERTRAINCODE.sas";
output;
id= "EMCODE";
property="EM_FILE_EMNOTES";
value= "EMCODE_EMNOTES.txt";
output;
run;
*------------------------------------------------------------*;
* Create connections data set;
*------------------------------------------------------------*;
data connect;
length from to $12;
from="EMCODE";
to="Prof";
output;
from="Smpl";
to="EMCODE";
output;
from="Ids";
to="Smpl";
output;
run;
*------------------------------------------------------------*;
* Create actions to run data set;
*------------------------------------------------------------*;
%macro emaction;
%let actionstring = %upcase(&EM_ACTION);
%if %index(&actionstring, RUN) or %index(&actionstring, REPORT) %then %do;
data actions;
length id $12 action $40;
id="Prof";
%if %index(&actionstring, RUN) %then %do;
action='run';
output;
%end;
%if %index(&actionstring, REPORT) %then %do;
action='report';
output;
%end;
run;
%end;
%mend;
%emaction;
*------------------------------------------------------------*;
* Execute the actions;
*------------------------------------------------------------*;
%em5batch(execute, workspace=workspace, nodes=nodes, connect=connect, datasources=datasources, nodeprops=nodeprops, action=actions);
